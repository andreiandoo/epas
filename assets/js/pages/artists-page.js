const ArtistsPage={filters:{genre:"",letter:"",sort:"popular",page:1,search:""},totalArtists:0,async init(t={}){this.filters={...this.filters,...t},await Promise.all([this.loadFeaturedArtists(),this.loadTrendingArtists(),this.loadArtists(),this.loadGenreCounts()]),this.bindEvents()},async loadFeaturedArtists(){const t=document.getElementById("featuredGrid");if(t)try{const e=await AmbiletAPI.get("/artists/featured?limit=4"),s=e.data?.artists||e.data||[];s.length>0&&(t.innerHTML=s.map(t=>this.renderFeaturedCard(t)).join(""))}catch(e){console.warn("Failed to load featured artists:",e),t.innerHTML='<p class="col-span-4 py-8 text-center text-muted">Nu am putut încărca artiștii populari</p>'}},async loadTrendingArtists(){const t=document.getElementById("trendingList");if(t)try{const e=await AmbiletAPI.get("/artists/trending?limit=4"),s=e.data?.artists||e.data||[];s.length>0&&(t.innerHTML=s.map((t,e)=>this.renderTrendingItem(t,e+1)).join(""))}catch(t){console.warn("Failed to load trending artists:",t)}},async loadArtists(){const t=document.getElementById("artistsGrid");if(t)try{const e=new URLSearchParams({page:this.filters.page,per_page:12,sort:this.filters.sort});this.filters.genre&&e.append("genre",this.filters.genre),this.filters.letter&&e.append("letter",this.filters.letter),this.filters.search&&e.append("search",this.filters.search);const s=await AmbiletAPI.get("/artists?"+e.toString());if(s.data){const e=s.data,r=s.meta||{};this.totalArtists=r.total||e.length;const a=document.getElementById("resultsCount");a&&(a.textContent=this.totalArtists),e.length>0?t.innerHTML=e.map(t=>this.renderArtistCard(t)).join(""):t.innerHTML=this.getEmptyState(),this.renderPagination(r)}}catch(e){console.error("Failed to load artists:",e),t.innerHTML='<p class="py-8 text-center col-span-full text-error">Eroare la încărcarea artiștilor</p>'}},async loadGenreCounts(){try{const t=await AmbiletAPI.get("/artists?per_page=1"),e=t.meta?.total||0,s=document.getElementById("countAll");s&&(s.textContent=e||"--");const r=await AmbiletAPI.get("/artists/genre-counts"),a=r.data?.genres||[],i={};a.forEach(t=>{i[t.slug]=t.count});const l={countPop:"pop",countRock:"rock",countHipHop:"hip-hop",countElectronic:"electronic",countStandup:"stand-up",countDJ:"dj"};Object.entries(l).forEach(([t,e])=>{const s=document.getElementById(t);s&&(s.textContent=i[e]||"--")})}catch(t){console.warn("Failed to load genre counts:",t)}},renderFeaturedCard(t){const e=t.is_verified?'<span class="inline-flex items-center justify-center w-5 h-5 ml-1 bg-blue-500 rounded-full"><svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></span>':"",s=t.genres?.[0]?.name||"Artist",r=this.formatFollowers(this.calculateTotalFollowers(t)),a=t.upcoming_events_count||0,i=t.portrait||t.logo||t.image||"/assets/images/default-artist.png";return'<a href="/artist/'+this.escapeHtml(t.slug)+'" class="relative overflow-hidden group rounded-2xl aspect-[3/4]"><img src="'+this.escapeHtml(i)+'" alt="'+this.escapeHtml(t.name)+'" class="object-cover w-full h-full transition-transform duration-500 group-hover:scale-110" loading="lazy"><div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div><div class="absolute bottom-0 left-0 right-0 p-6"><span class="inline-block px-3 py-1 mb-3 text-xs font-semibold text-white uppercase rounded-full bg-white/15 backdrop-blur-sm">'+this.escapeHtml(s)+'</span><h3 class="mb-2 text-xl font-extrabold leading-tight text-white">'+this.escapeHtml(t.name)+e+'</h3><div class="flex items-center gap-4 text-sm text-white/80"><span class="flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>'+(0===a?"Fără evenimente":1===a?"1 eveniment":a+" evenimente")+'</span><span class="flex items-center gap-1.5"><svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>'+r+"</span></div></div></a>"},renderTrendingItem(t,e){const s=1===e?"bg-gradient-to-br from-yellow-400 to-yellow-600":2===e?"bg-gradient-to-br from-gray-400 to-gray-500":3===e?"bg-gradient-to-br from-amber-600 to-amber-700":"bg-secondary",r=t.is_verified?'<span class="inline-flex items-center justify-center w-4 h-4 ml-1 bg-blue-500 rounded-full"><svg class="w-2.5 h-2.5 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></span>':"",a=(t.change||0)>=0?"bg-green-100 text-green-600":"bg-red-100 text-red-600",i=(t.change||0)>=0?'<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="18 15 12 9 6 15"/></svg>':'<svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="6 9 12 15 18 9"/></svg>',l=((t.change||0)>=0?"+":"")+(t.change||0)+"%",n=t.portrait||t.logo||t.image||"/assets/images/default-artist.png";return'<a href="/artist/'+this.escapeHtml(t.slug)+'" class="flex items-center gap-4 p-4 transition-colors rounded-2xl bg-surface hover:bg-border/50"><div class="flex items-center justify-center flex-shrink-0 w-8 h-8 text-sm font-bold text-white rounded-lg '+s+'">'+e+'</div><div class="flex-shrink-0 overflow-hidden w-14 h-14 rounded-xl"><img src="'+this.escapeHtml(n)+'" alt="'+this.escapeHtml(t.name)+'" class="object-cover w-full h-full" loading="lazy"></div><div class="flex-1 min-w-0"><div class="flex items-center text-sm font-bold text-secondary">'+this.escapeHtml(t.name)+r+'</div><div class="text-xs text-muted">'+(t.tickets_sold||0)+' bilete vândute săptămâna aceasta</div></div><div class="flex items-center gap-1 px-2.5 py-1 text-xs font-semibold rounded-md '+a+'">'+i+l+"</div></a>"},renderArtistCard(t){const e=t.is_verified?'<span class="inline-flex items-center justify-center w-4 h-4 ml-1 bg-blue-500 rounded-full"><svg class="w-2.5 h-2.5 text-white" fill="currentColor" viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg></span>':"",s=t.genres?.[0]?.name||"Artist",r=this.formatFollowers(this.calculateTotalFollowers(t)),a=t.upcoming_events_count||0,i=t.portrait||t.logo||t.image||"/assets/images/default-artist.png",l=a>0?'<span class="inline-flex items-center gap-1.5 px-3 py-2 text-xs font-semibold rounded-lg bg-primary/10 text-primary"><svg class="w-3.5 h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>'+(1===a?"1 eveniment viitor":a+" evenimente viitoare")+"</span>":'<span class="text-xs text-muted">Fără evenimente programate</span>';return'<a href="/artist/'+this.escapeHtml(t.slug)+'" class="overflow-hidden transition-all bg-white border group rounded-2xl border-border hover:-translate-y-1 hover:shadow-xl hover:border-primary"><div class="relative overflow-hidden aspect-square"><img src="'+this.escapeHtml(i)+'" alt="'+this.escapeHtml(t.name)+'" class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105" loading="lazy"><span class="absolute px-3 py-1.5 text-xs font-semibold text-white uppercase rounded-full top-3 left-3 bg-black/60 backdrop-blur-sm">'+this.escapeHtml(s)+'</span></div><div class="p-5 text-center"><h3 class="flex items-center justify-center mb-1 text-base font-bold text-secondary">'+this.escapeHtml(t.name)+e+'</h3><p class="mb-3 text-sm text-muted">'+r+" urmăritori</p>"+l+"</div></a>"},getEmptyState:()=>'<div class="py-16 text-center col-span-full"><svg class="w-16 h-16 mx-auto mb-4 text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg><h3 class="mb-2 text-lg font-semibold text-secondary">Nu am găsit artiști</h3><p class="text-muted">Încearcă să modifici filtrele sau să cauți altceva</p></div>',renderPagination(t){const e=document.getElementById("pagination");if(!e)return;if(!t||t.last_page<=1)return void(e.innerHTML="");let s="";t.current_page>1&&(s+='<button onclick="ArtistsPage.goToPage('+(t.current_page-1)+')" class="flex items-center justify-center w-10 h-10 transition-colors bg-white border rounded-xl border-border hover:bg-surface"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg></button>');for(let e=1;e<=t.last_page;e++)e===t.current_page?s+='<button class="w-10 h-10 font-bold text-white rounded-xl bg-primary">'+e+"</button>":1===e||e===t.last_page||Math.abs(e-t.current_page)<=2?s+='<button onclick="ArtistsPage.goToPage('+e+')" class="w-10 h-10 font-medium transition-colors bg-white border rounded-xl border-border hover:bg-surface">'+e+"</button>":3===Math.abs(e-t.current_page)&&(s+='<span class="px-2 text-muted">...</span>');t.current_page<t.last_page&&(s+='<button onclick="ArtistsPage.goToPage('+(t.current_page+1)+')" class="flex items-center justify-center w-10 h-10 transition-colors bg-white border rounded-xl border-border hover:bg-surface"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg></button>'),e.innerHTML=s},goToPage(t){this.filters.page=t,this.loadArtists(),window.scrollTo({top:400,behavior:"smooth"})},setGenre(t){this.filters.genre=t,this.filters.page=1,document.querySelectorAll(".genre-tab").forEach(e=>{const s=e.dataset.genre===t;e.classList.toggle("bg-primary",s),e.classList.toggle("text-white",s),e.classList.toggle("bg-white",!s),e.classList.toggle("border",!s),e.classList.toggle("border-border",!s),e.classList.toggle("text-muted",!s)}),this.loadArtists()},setLetter(t){this.filters.letter=t||"",this.filters.page=1,document.querySelectorAll(".alphabet-link").forEach(e=>{const s=e.dataset.letter===t;e.classList.toggle("bg-primary",s),e.classList.toggle("text-white",s),e.classList.toggle("bg-surface",!s),e.classList.toggle("text-muted",!s)}),this.loadArtists()},search(){const t=document.getElementById("artistSearch")?.value?.trim();t&&t.length>=2&&(this.filters.search=t,this.filters.page=1,this.loadArtists())},clearSearch(){this.filters.search="";const t=document.getElementById("artistSearch");t&&(t.value=""),this.filters.page=1,this.loadArtists()},subscribeNewsletter(t){t.preventDefault();const e=document.getElementById("newsletterEmail"),s=e?.value;return s&&("undefined"!=typeof AmbiletNotifications&&AmbiletNotifications.success("Te-ai abonat cu succes!"),e&&(e.value="")),!1},bindEvents(){document.querySelectorAll(".genre-tab").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault(),this.setGenre(t.currentTarget.dataset.genre)})});const t=document.getElementById("sortSelect");t&&t.addEventListener("change",t=>{this.filters.sort=t.target.value,this.filters.page=1,this.loadArtists()});const e=document.getElementById("artistSearch");e&&e.addEventListener("keypress",t=>{"Enter"===t.key&&this.search()}),document.querySelectorAll(".alphabet-link").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault(),this.setLetter(t.currentTarget.dataset.letter)})})},calculateTotalFollowers(t){const e=t.stats||{};return(e.spotify_listeners||0)+(e.instagram_followers||0)+(e.facebook_followers||0)+(e.youtube_subscribers||0)+(e.tiktok_followers||0)},formatFollowers:t=>t&&0!==t?t>=1e6?(t/1e6).toFixed(1).replace(/\.0$/,"")+"M":t>=1e3?(t/1e3).toFixed(1).replace(/\.0$/,"")+"K":t.toString():"0",escapeHtml(t){if(!t)return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}};window.ArtistsPage=ArtistsPage;