const VenuePage={venueSlug:"",venue:null,isFollowing:!1,monthNames:["IAN","FEB","MAR","APR","MAI","IUN","IUL","AUG","SEP","OCT","NOI","DEC"],elements:{hero:"venueHero",heroImage:"heroImage",breadcrumbName:"breadcrumbName",venueType:"venueType",venueName:"venueName",venueLocation:"venueLocation",venueCapacity:"venueCapacity",venueEventsCount:"venueEventsCount",venueRating:"venueRating",venueYear:"venueYear",venueAbout:"venueAbout",quickInfo:"quickInfo",venueAddress:"venueAddress",mapsLink:"mapsLink",venueMap:"venueMap",venueAmenities:"venueAmenities",amenitiesSection:"amenitiesSection",venueGallery:"venueGallery",gallerySection:"gallerySection",eventsList:"eventsList",similarVenues:"similarVenues",similarVenuesSection:"similarVenuesSection",followBtn:"follow-btn",followIcon:"follow-icon",followText:"follow-text"},async init(){this.venueSlug=window.VENUE_SLUG||"",this.venueSlug?(await this.loadVenueData(),this.loadFollowStatus()):this.showError("Locația nu a fost găsită")},async loadVenueData(){try{var e=await AmbiletAPI.getVenue(this.venueSlug);e.success&&e.data?(this.venue=this.transformApiData(e.data),this.render()):this.showError("Locația nu a fost găsită")}catch(e){console.error("Failed to load venue:",e),404===e.status?this.showError("Locația nu a fost găsită"):this.showError("Eroare la încărcarea datelor")}},transformApiData(e){if(!e)return null;var t=this,n=[];e.upcoming_events&&e.upcoming_events.length>0&&(n=e.upcoming_events.map(function(e){var n=new Date(e.event_date||e.starts_at);return{slug:e.slug,day:String(n.getDate()).padStart(2,"0"),month:t.monthNames[n.getMonth()],category:e.category||"Eveniment",title:e.title||e.name,time:e.start_time?e.start_time.substring(0,5):"20:00",price:e.min_price||e.price_from||0,currency:e.currency||"RON",is_sold_out:e.is_sold_out||!1}}));var s="Locație";e.categories&&e.categories.length>0?s=e.categories[0].name:e.type&&(s=e.type);var a=[e.address];e.city&&a.push(e.city),e.postal_code&&a.push(e.postal_code);var i=a.filter(Boolean).join(", "),r=e.capacity?e.capacity.toLocaleString("ro-RO"):"-",o=[];return e.similar_venues&&e.similar_venues.length>0&&(o=e.similar_venues.map(function(e){return{slug:e.slug,name:e.name,location:e.city+(e.capacity?" · "+e.capacity.toLocaleString("ro-RO")+" locuri":""),events:e.events_count||0,image:e.image||"/assets/images/default_venue.jpg"}})),{name:e.name||"Locație necunoscută",slug:e.slug,type:s,location:e.city||"",address:i,latitude:e.latitude||e.lat,longitude:e.longitude||e.lng,capacity:r,rating:e.rating||"-",reviewsCount:e.reviews_count||0,yearBuilt:e.year_built||"-",eventsCount:e.events_count||n.length,image:e.cover_image||e.image||"/assets/images/default_venue.jpg",description:e.description||"",phone:e.phone||(e.contact?e.contact.phone:null)||"",email:e.email||(e.contact?e.contact.email:null)||"",website:e.website||(e.contact?e.contact.website:null)||"",facebook:e.social?e.social.facebook:e.facebook_url||"",instagram:e.social?e.social.instagram:e.instagram_url||"",tiktok:e.social?e.social.tiktok:e.tiktok_url||"",schedule:e.schedule||"În funcție de evenimente",amenities:e.amenities||[],gallery:e.gallery||e.images||[],events:n,rawEvents:e.upcoming_events||[],similarVenues:o}},showError(e){var t=document.querySelector(".skeleton-hero");t&&t.remove();var n=document.getElementById(this.elements.hero);n&&(n.innerHTML='<div class="flex items-center justify-center h-full bg-gray-100"><div class="text-center"><svg class="w-16 h-16 mx-auto mb-4 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg><h2 class="text-xl font-bold text-gray-700">'+this.escapeHtml(e)+'</h2><a href="/locatii" class="inline-block px-6 py-3 mt-4 text-white rounded-lg bg-primary hover:bg-primary-dark">Vezi toate locațiile</a></div></div>')},render(){var e=this.venue,t=document.getElementById(this.elements.heroImage);t&&(t.src=e.image,t.alt=e.name,t.classList.remove("hidden"));var n=document.querySelector(".skeleton-hero");n&&n.remove(),this.setTextContent(this.elements.breadcrumbName,e.name),this.setTextContent(this.elements.venueType,e.type),this.setTextContent(this.elements.venueName,e.name),this.setTextContent(this.elements.venueLocation,e.location),document.title=e.name+" - "+(window.AMBILET_CONFIG?.SITE_NAME||"Bilete.online"),this.setTextContent(this.elements.venueCapacity,e.capacity),this.setTextContent(this.elements.venueEventsCount,e.eventsCount),this.setTextContent(this.elements.venueRating,e.rating),this.setTextContent(this.elements.venueYear,e.yearBuilt),this.renderAbout(e.description),this.renderQuickInfo(e);var s=document.getElementById(this.elements.venueAddress);s&&(s.innerHTML=this.escapeHtml(e.address).replace(/, /g,"<br>")),this.renderMap(e);var a=document.getElementById(this.elements.mapsLink);a&&(e.latitude&&e.longitude?a.href="https://www.google.com/maps/search/?api=1&query="+e.latitude+","+e.longitude:e.address&&(a.href="https://www.google.com/maps/search/?api=1&query="+encodeURIComponent(e.address))),this.renderAmenities(e.amenities),this.renderGallery(e.gallery),this.renderEvents(e.rawEvents&&e.rawEvents.length>0?e.rawEvents:e.events),this.renderSimilarVenues(e.similarVenues)},setTextContent(e,t){var n=document.getElementById(e);n&&(n.textContent=t||"")},renderAbout(e){var t=document.getElementById(this.elements.venueAbout);if(t)if(e){var n=/<[a-z][\s\S]*>/i.test(e);t.innerHTML=n?'<div class="prose prose-sm max-w-none text-gray-600">'+e+"</div>":'<p class="text-base leading-relaxed text-gray-600 whitespace-pre-line">'+this.escapeHtml(e)+"</p>"}else t.innerHTML='<p class="italic text-gray-500">Informații despre această locație vor fi disponibile în curând.</p>'},renderQuickInfo(e){var t=document.getElementById(this.elements.quickInfo);if(t){var n="";if(e.schedule&&"-"!==e.schedule&&(n+=this.renderInfoRow('<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>',"Program",e.schedule)),e.phone&&"-"!==e.phone&&(n+=this.renderInfoRow('<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72"/></svg>',"Telefon",'<a href="tel:'+this.escapeHtml(e.phone)+'" class="text-primary">'+this.escapeHtml(e.phone)+"</a>",!0)),e.email&&"-"!==e.email&&(n+=this.renderInfoRow('<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>',"Email",'<a href="mailto:'+this.escapeHtml(e.email)+'" class="text-primary">'+this.escapeHtml(e.email)+"</a>",!0)),e.website&&"-"!==e.website&&""!==e.website){var s=e.website.startsWith("http")?e.website:"https://"+e.website,a=e.website.replace(/^https?:\/\//,"").replace(/\/$/,"");n+=this.renderInfoRow('<svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>',"Website",'<a href="'+this.escapeHtml(s)+'" target="_blank" class="text-primary">'+this.escapeHtml(a)+"</a>",!0)}var i=[];e.facebook&&i.push('<a href="'+this.escapeHtml(e.facebook)+'" target="_blank" class="flex items-center justify-center w-10 h-10 transition-all rounded-xl bg-surface text-muted hover:text-primary hover:bg-red-50" title="Facebook"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>'),e.instagram&&i.push('<a href="'+this.escapeHtml(e.instagram)+'" target="_blank" class="flex items-center justify-center w-10 h-10 transition-all rounded-xl bg-surface text-muted hover:text-primary hover:bg-red-50" title="Instagram"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg></a>'),e.tiktok&&i.push('<a href="'+this.escapeHtml(e.tiktok)+'" target="_blank" class="flex items-center justify-center w-10 h-10 transition-all rounded-xl bg-surface text-muted hover:text-primary hover:bg-red-50" title="TikTok"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24"><path d="M19.59 6.69a4.83 4.83 0 01-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 01-2.88 2.5 2.89 2.89 0 01-2.89-2.89 2.89 2.89 0 012.89-2.89c.28 0 .54.04.79.1v-3.5a6.37 6.37 0 00-.79-.05A6.34 6.34 0 003.15 15.2a6.34 6.34 0 0010.86 4.43v-7.15a8.16 8.16 0 005.58 2.19V11.2a4.85 4.85 0 01-3.77-1.74V6.69h3.77z"/></svg></a>'),i.length>0&&(n+='<div class="flex gap-2 pt-3">'+i.join("")+"</div>"),n||(n='<p class="py-3 text-sm italic text-gray-500">Informații de contact indisponibile</p>'),t.innerHTML=n}},renderInfoRow(e,t,n,s,a){return void 0===a&&(a=!0),'<div class="flex items-start gap-3.5 py-3.5 '+(a?"border-b border-gray-100":"")+'"><div class="flex items-center justify-center flex-shrink-0 w-10 h-10 bg-surface rounded-xl text-muted">'+e+'</div><div><div class="mb-1 text-xs tracking-wide uppercase text-muted">'+t+'</div><div class="text-sm font-semibold text-secondary">'+(s?n:this.escapeHtml(n))+"</div></div></div>"},renderMap(e){var t=document.getElementById(this.elements.venueMap);if(t){var n="";e.latitude&&e.longitude?n=e.latitude+","+e.longitude:e.address&&(n=encodeURIComponent(e.address)),t.innerHTML=n?'<iframe src="https://www.google.com/maps?q='+n+'&output=embed" width="100%" height="100%" style="border:0; min-height:192px;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>':'<div class="flex flex-col items-center justify-center h-full gap-3 text-muted"><svg class="w-10 h-10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg><p class="text-sm">Locație indisponibilă</p></div>'}},renderAmenities(e){var t=document.getElementById(this.elements.venueAmenities),n=document.getElementById(this.elements.amenitiesSection);if(t)if(e&&0!==e.length){n&&(n.style.display="");var s=this,a=e.map(function(e){return'<div class="flex items-center gap-2.5 p-3 bg-surface rounded-xl"><svg class="w-4 h-4 text-success" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 11 12 14 22 4"/></svg><span class="text-sm font-medium text-gray-600">'+s.escapeHtml(e)+"</span></div>"}).join("");t.innerHTML=a}else n&&(n.style.display="none")},renderGallery(e){var t=document.getElementById(this.elements.venueGallery),n=document.getElementById(this.elements.gallerySection);if(t)if(e&&0!==e.length){n&&(n.style.display="");var s=this,a=e.slice(0,5).map(function(t,n){var a=0===n?"col-span-2 row-span-2":"",i=0===n?"aspect-auto":"aspect-[4/3]",r=4===n&&e.length>5?'<div class="absolute inset-0 flex items-center justify-center text-lg font-bold text-white bg-black/60">+'+(e.length-5)+"</div>":"";return'<div class="'+a+" relative rounded-xl overflow-hidden "+i+' cursor-pointer group"><img src="'+s.escapeHtml(t)+'" alt="Galerie" class="object-cover w-full h-full transition-transform duration-500 group-hover:scale-105" loading="lazy"><div class="absolute inset-0 transition-all bg-black/0 group-hover:bg-black/30"></div>'+r+"</div>"}).join("");t.innerHTML=a}else n&&(n.style.display="none")},renderEvents(e){var t=document.getElementById(this.elements.eventsList);t&&(e&&0!==e.length?t.innerHTML=AmbiletEventCard.renderManyHorizontal(e,{urlPrefix:"/bilete/",showBuyButton:!0,showArtists:!0}):t.innerHTML='<div class="p-8 text-center bg-white border rounded-2xl border-border"><svg class="w-12 h-12 mx-auto mb-3 text-gray-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg><p class="text-gray-500">Nu există evenimente programate la această locație</p></div>')},renderSimilarVenues(e){var t=document.getElementById(this.elements.similarVenues),n=document.getElementById(this.elements.similarVenuesSection);if(t)if(e&&0!==e.length){n&&(n.style.display="");var s=this,a=e.map(function(e){return'<a href="/locatie/'+s.escapeHtml(e.slug)+'" class="overflow-hidden transition-all bg-white border rounded-2xl border-border hover:-translate-y-1 hover:shadow-lg hover:border-primary"><div class="aspect-[16/10] overflow-hidden"><img src="'+s.escapeHtml(e.image)+'" alt="'+s.escapeHtml(e.name)+'" class="object-cover w-full h-full transition-transform duration-300 group-hover:scale-105" loading="lazy"></div><div class="p-4"><h3 class="mb-1 text-base font-bold text-secondary">'+s.escapeHtml(e.name)+'</h3><p class="mb-2 text-sm text-muted">'+s.escapeHtml(e.location)+'</p><span class="text-xs font-semibold text-primary">'+e.events+" evenimente</span></div></a>"}).join("");t.innerHTML=a}else n&&(n.style.display="none")},escapeHtml(e){if(!e)return"";var t=document.createElement("div");return t.textContent=e,t.innerHTML},async loadFollowStatus(){if(this.venueSlug)try{var e=await AmbiletAPI.checkVenueFavorite(this.venueSlug);e.success&&e.data&&(this.isFollowing=e.data.is_favorite,this.updateFollowButton())}catch(e){console.log("[VenuePage] Follow status check skipped")}},async toggleFollow(){if(this.venueSlug)if(AmbiletAuth.isLoggedIn())try{var e=await AmbiletAPI.toggleVenueFavorite(this.venueSlug);console.log("[VenuePage] Toggle follow response:",e),e.success&&e.data&&(this.isFollowing=e.data.is_favorite,this.updateFollowButton())}catch(e){console.error("[VenuePage] Toggle follow failed:",e),401===e.status&&(window.location.href="/cont/autentificare?redirect="+encodeURIComponent(window.location.pathname))}else window.location.href="/cont/autentificare?redirect="+encodeURIComponent(window.location.pathname)},openContactModal(){var e=document.getElementById("contactVenueModal");if(e){e.classList.remove("hidden"),e.style.display="flex",document.body.style.overflow="hidden";var t=document.getElementById("contactVenueName");if(t&&this.venue&&(t.textContent=this.venue.name),"undefined"!=typeof AmbiletAuth&&AmbiletAuth.isLoggedIn()){var n=AmbiletAuth.getUser(),s=document.getElementById("contactVenueForm");n&&s&&(n.name&&(s.querySelector('[name="name"]').value=n.name),n.email&&(s.querySelector('[name="email"]').value=n.email))}document.getElementById("contactFormError").classList.add("hidden"),document.getElementById("contactFormSuccess").classList.add("hidden")}},closeContactModal(e){if(!e||e.target===e.currentTarget){var t=document.getElementById("contactVenueModal");t&&(t.classList.add("hidden"),t.style.display="",document.body.style.overflow="")}},async submitContactForm(e){e.preventDefault();var t=document.getElementById("contactVenueForm"),n=document.getElementById("contactSubmitBtn"),s=document.getElementById("contactFormError"),a=document.getElementById("contactFormSuccess");if(t&&this.venueSlug){n.disabled=!0,n.querySelector("span").textContent="Se trimite...",s.classList.add("hidden"),a.classList.add("hidden");var i={name:t.querySelector('[name="name"]').value.trim(),email:t.querySelector('[name="email"]').value.trim(),subject:t.querySelector('[name="subject"]').value.trim(),message:t.querySelector('[name="message"]').value.trim()};try{var r=await AmbiletAPI.post("/venues/"+this.venueSlug+"/contact",i);r.success?(a.textContent="Mesajul tău a fost trimis cu succes! Locația va reveni cu un răspuns.",a.classList.remove("hidden"),t.reset(),setTimeout(function(){VenuePage.closeContactModal()},3e3)):(s.textContent=r.message||"Eroare la trimiterea mesajului. Încearcă din nou.",s.classList.remove("hidden"))}catch(e){var o="Eroare la trimiterea mesajului. Încearcă din nou.";e.data&&e.data.message?o=e.data.message:e.message&&(o=e.message),s.textContent=o,s.classList.remove("hidden")}finally{n.disabled=!1,n.querySelector("span").textContent="Trimite mesajul"}}},updateFollowButton(){var e=document.getElementById(this.elements.followBtn),t=document.getElementById(this.elements.followText);e&&t&&(this.isFollowing?(e.classList.remove("bg-white/20","hover:bg-white/30"),e.classList.add("bg-primary","hover:bg-primary-dark"),t.textContent="Urmărești locația"):(e.classList.remove("bg-primary","hover:bg-primary-dark"),e.classList.add("bg-white/20","hover:bg-white/30"),t.textContent="Urmărește locația"))}};window.VenuePage=VenuePage;